# Session 5: Secret κ΄€λ¦¬μ™€ μ•”νΈν™” μ „λµ

## π“ κµκ³Όκ³Όμ •μ—μ„μ μ„μΉ
μ΄ μ„Έμ…μ€ **Week 3 > Day 2 > Session 5**λ΅, Kubernetesμ Secret κ΄€λ¦¬μ™€ μ•”νΈν™” μ „λµμ„ ν•™μµν•©λ‹λ‹¤.

## ν•™μµ λ©ν‘ (5λ¶„)
- **Secret μƒλ…μ£ΌκΈ°** κ΄€λ¦¬μ™€ **λ³΄μ• λ¨λ²” μ‚¬λ΅€** μ΄ν•΄
- **μ™Έλ¶€ μ‹ν¬λ¦Ώ κ΄€λ¦¬** μ‹μ¤ν… ν†µν•© λ°©λ²• ν•™μµ
- **μ•”νΈν™” ν‚¤ κ΄€λ¦¬** (KMS μ—°λ™)μ™€ **λ°μ΄ν„° λ³΄νΈ** μ „λµ νμ•…
- **μ‹ν¬λ¦Ώ λ΅ν…μ΄μ…**κ³Ό **μλ™ν™”** κµ¬ν„ λ°©λ²• μ΄ν•΄

## 1. Secret μƒλ…μ£ΌκΈ° κ΄€λ¦¬ (15λ¶„)

### Secret κ΄€λ¦¬ μ•„ν‚¤ν…μ²

```mermaid
graph TB
    subgraph "Secret μƒλ…μ£ΌκΈ°"
        A[μƒμ„±] --> B[μ €μ¥]
        B --> C[λ°°ν¬]
        C --> D[μ‚¬μ©]
        D --> E[λ΅ν…μ΄μ…]
        E --> F[νκΈ°]
        
        G[μ•”νΈν™”] --> B
        H[μ ‘κ·Ό μ μ–΄] --> C
        I[κ°μ‚¬] --> D
        J[μλ™ν™”] --> E
    end
```

### Secret κ΄€λ¦¬ μ „λµ
```
Secret μƒλ…μ£ΌκΈ° κ΄€λ¦¬:

Secret νƒ€μ… λ° μ©λ„:
   π”Ή Opaque: μΌλ°μ μΈ μ‹ν¬λ¦Ώ
   π”Ή kubernetes.io/service-account-token: μ„λΉ„μ¤ κ³„μ • ν† ν°
   π”Ή kubernetes.io/dockercfg: Docker λ μ§€μ¤νΈλ¦¬ μΈμ¦
   π”Ή kubernetes.io/tls: TLS μΈμ¦μ„ λ° ν‚¤
   π”Ή kubernetes.io/ssh-auth: SSH μΈμ¦ ν‚¤
   π”Ή kubernetes.io/basic-auth: κΈ°λ³Έ μΈμ¦ μ •λ³΄
   π”Ή μ»¤μ¤ν…€ νƒ€μ…: μ• ν”λ¦¬μΌ€μ΄μ…λ³„ μ‹ν¬λ¦Ώ

μƒμ„± λ° μ €μ¥:
   π”Ή μƒμ„± λ°©λ²•:
      β€Ά kubectl create secret
      β€Ά YAML λ§¤λ‹νμ¤νΈ
      β€Ά μ™Έλ¶€ λ„κµ¬ ν†µν•©
      β€Ά CI/CD νμ΄ν”„λΌμΈ
      β€Ά μλ™ μƒμ„± (cert-manager)
   π”Ή μ €μ¥ λ³΄μ•:
      β€Ά etcd μ•”νΈν™”
      β€Ά μ „μ†΅ μ¤‘ μ•”νΈν™”
      β€Ά μ ‘κ·Ό κ¶ν• μ ν•
      β€Ά λ°±μ—… μ•”νΈν™”
      β€Ά κ°μ‚¬ λ΅κΉ…
   π”Ή λ°μ΄ν„° ν•μ‹:
   π”Ή Base64 μΈμ½”λ”©
   π”Ή λ°”μ΄λ„λ¦¬ λ°μ΄ν„° μ§€μ›
   π”Ή ν‚¤-κ°’ μ κµ¬μ΅°
   π”Ή λ©”νƒ€λ°μ΄ν„° ν¬ν•¨
   π”Ή λΌλ²¨ λ° μ–΄λ…Έν…μ΄μ…

λ°°ν¬ λ° μ‚¬μ©:
   π”Ή λ§μ΄νΈ λ°©λ²•:
      β€Ά λ³Όλ¥¨ λ§μ΄νΈ
      β€Ά ν™κ²½ λ³€μ
      β€Ά νμΌ μ‹μ¤ν… λ§μ΄νΈ
      β€Ά λ©”λ¨λ¦¬ κΈ°λ° tmpfs
      β€Ά ν”„λ΅μ μ… λ³Όλ¥¨
   π”Ή μ ‘κ·Ό μ μ–΄:
      β€Ά RBAC κ¶ν• μ„¤μ •
      β€Ά λ„¤μ„μ¤νμ΄μ¤ κ²©λ¦¬
      β€Ά Pod λ λ²¨ μ ν•
      β€Ά μ„λΉ„μ¤ κ³„μ • κΈ°λ°
      β€Ά λ„¤νΈμ›ν¬ μ •μ±… μ μ©
   π”Ή λ³΄μ• κ³ λ ¤μ‚¬ν•­:
   π”Ή μµμ† κ¶ν• μ›μΉ™
   π”Ή λ΅κ·Έ λ…Έμ¶ λ°©μ§€
   π”Ή λ©”λ¨λ¦¬ λ¤ν”„ λ³΄νΈ
   π”Ή ν”„λ΅μ„Έμ¤ κ²©λ¦¬
   π”Ή μ»¨ν…μ΄λ„ λ³΄μ•
```

## 2. μ™Έλ¶€ μ‹ν¬λ¦Ώ κ΄€λ¦¬ μ‹μ¤ν… ν†µν•© (12λ¶„)

### μ™Έλ¶€ μ‹ν¬λ¦Ώ ν†µν•© μ•„ν‚¤ν…μ²

```mermaid
graph TB
    subgraph "μ™Έλ¶€ μ‹ν¬λ¦Ώ κ΄€λ¦¬"
        A[HashiCorp Vault] --> B[Vault Agent]
        C[AWS Secrets Manager] --> D[External Secrets Operator]
        E[Azure Key Vault] --> F[CSI Secret Store]
        G[Google Secret Manager] --> H[Workload Identity]
        
        B --> I[Kubernetes Secret]
        D --> I
        F --> I
        H --> I
    end
```

### μ™Έλ¶€ μ‹μ¤ν… ν†µν•© μ „λµ
```
μ™Έλ¶€ μ‹ν¬λ¦Ώ κ΄€λ¦¬ μ‹μ¤ν… ν†µν•©:

HashiCorp Vault ν†µν•©:
   π”Ή Vault Agent Injector:
      β€Ά μ‚¬μ΄λ“μΉ΄ ν¨ν„΄
      β€Ά μλ™ μ‹ν¬λ¦Ώ μ£Όμ…
      β€Ά ν…ν”λ¦Ώ κΈ°λ° λ λ”λ§
      β€Ά μλ™ κ°±μ‹ 
      β€Ά λ™μ  μ‹ν¬λ¦Ώ μ§€μ›
   π”Ή Vault CSI Provider:
      β€Ά CSI λ“λΌμ΄λ²„ ν™μ©
      β€Ά λ³Όλ¥¨ λ§μ΄νΈ λ°©μ‹
      β€Ά νμΌ μ‹μ¤ν… κΈ°λ°
      β€Ά μλ™ λ΅ν…μ΄μ…
      β€Ά λ‹¤μ¤‘ μ‹ν¬λ¦Ώ μ§€μ›
   π”Ή External Secrets Operator:
   π”Ή CRD κΈ°λ° κ΄€λ¦¬
   π”Ή λ‹¤μ–‘ν• λ°±μ—”λ“ μ§€μ›
   π”Ή μλ™ λ™κΈ°ν™”
   π”Ή μ •μ±… κΈ°λ° μ μ–΄
   π”Ή λ¨λ‹ν„°λ§ ν†µν•©

ν΄λΌμ°λ“ μ‹ν¬λ¦Ώ μ„λΉ„μ¤:
   π”Ή AWS Secrets Manager:
      β€Ά IAM κΈ°λ° μΈμ¦
      β€Ά μλ™ λ΅ν…μ΄μ…
      β€Ά λ²„μ „ κ΄€λ¦¬
      β€Ά κµμ°¨ λ¦¬μ „ λ³µμ 
      β€Ά κ°μ‚¬ λ΅κΉ…
   π”Ή Azure Key Vault:
      β€Ά Azure AD ν†µν•©
      β€Ά ν•λ“μ›¨μ–΄ λ³΄μ• λ¨λ“
      β€Ά μΈμ¦μ„ κ΄€λ¦¬
      β€Ά ν‚¤ κ΄€λ¦¬
      β€Ά μ•΅μ„Έμ¤ μ •μ±…
   π”Ή Google Secret Manager:
   π”Ή Workload Identity
   π”Ή μλ™ μ•”νΈν™”
   π”Ή λ²„μ „ κ΄€λ¦¬
   π”Ή κ°μ‚¬ λ΅κΉ…
   π”Ή IAM ν†µν•©
```

## 3. μ•”νΈν™” ν‚¤ κ΄€λ¦¬μ™€ KMS μ—°λ™ (10λ¶„)

### μ•”νΈν™” μ•„ν‚¤ν…μ²

```mermaid
graph TB
    subgraph "μ•”νΈν™” κ³„μΈµ"
        A[Application] --> B[TLS/mTLS]
        C[Kubernetes] --> D[etcd μ•”νΈν™”]
        E[Storage] --> F[λ³Όλ¥¨ μ•”νΈν™”]
        G[Network] --> H[λ„¤νΈμ›ν¬ μ•”νΈν™”]
        
        I[KMS] --> J[ν‚¤ κ΄€λ¦¬]
        J --> B
        J --> D
        J --> F
        J --> H
    end
```

### μ•”νΈν™” μ „λµ
```
μ•”νΈν™” ν‚¤ κ΄€λ¦¬ λ° KMS μ—°λ™:

etcd μ•”νΈν™”:
   π”Ή μ €μ¥ λ°μ΄ν„° μ•”νΈν™”:
      β€Ά AES-256 μ•”νΈν™”
      β€Ά ν‚¤ λν•‘
      β€Ά λ‹¤μ¤‘ ν‚¤ μ§€μ›
      β€Ά ν‚¤ λ΅ν…μ΄μ…
      β€Ά μ„±λ¥ μµμ ν™”
   π”Ή KMS ν†µν•©:
      β€Ά AWS KMS
      β€Ά Azure Key Vault
      β€Ά Google Cloud KMS
      β€Ά HashiCorp Vault
      β€Ά μ¨ν”„λ λ―Έμ¤ HSM
   π”Ή μ„¤μ • κ΄€λ¦¬:
   π”Ή EncryptionConfiguration
   π”Ή ν‚¤ κ³„μΈµ κµ¬μ΅°
   π”Ή μ•”νΈν™” λ²”μ„ μ„¤μ •
   π”Ή μ„±λ¥ νλ‹
   π”Ή λ¨λ‹ν„°λ§ μ„¤μ •

μ „μ†΅ μ¤‘ μ•”νΈν™”:
   π”Ή ν΄λ¬μ¤ν„° λ‚΄λ¶€:
      β€Ά API μ„λ²„ TLS
      β€Ά etcd ν΄λΌμ΄μ–ΈνΈ TLS
      β€Ά kubelet TLS
      β€Ά μ„λΉ„μ¤ λ©”μ‹ mTLS
      β€Ά CNI μ•”νΈν™”
   π”Ή μ™Έλ¶€ ν†µμ‹ :
      β€Ά Ingress TLS
      β€Ά LoadBalancer TLS
      β€Ά μ™Έλ¶€ μ„λΉ„μ¤ μ—°λ™
      β€Ά ν΄λΌμ°λ“ μ„λΉ„μ¤ ν†µμ‹ 
      β€Ά ν•μ΄λΈλ¦¬λ“ μ—°κ²°
   π”Ή μΈμ¦μ„ κ΄€λ¦¬:
   π”Ή cert-manager
   π”Ή μλ™ κ°±μ‹ 
   π”Ή μΈμ¦μ„ μ²΄μΈ
   π”Ή OCSP κ²€μ¦
   π”Ή μΈμ¦μ„ λ¨λ‹ν„°λ§
```

## 4. μ‹ν¬λ¦Ώ λ΅ν…μ΄μ…κ³Ό μλ™ν™” (10λ¶„)

### μλ™ν™” μ›ν¬ν”λ΅μ°

```mermaid
graph TB
    subgraph "μ‹ν¬λ¦Ώ λ΅ν…μ΄μ…"
        A[μ¤μΌ€μ¤„λ¬] --> B[λ΅ν…μ΄μ… νΈλ¦¬κ±°]
        B --> C[μƒ μ‹ν¬λ¦Ώ μƒμ„±]
        C --> D[λ°°ν¬ λ° κ²€μ¦]
        D --> E[μ΄μ „ μ‹ν¬λ¦Ώ νκΈ°]
        
        F[λ¨λ‹ν„°λ§] --> G[λ§λ£ κ°μ§€]
        G --> B
        
        H[μ΄λ²¤νΈ] --> I[κΈ΄κΈ‰ λ΅ν…μ΄μ…]
        I --> B
    end
```

### μλ™ν™” κµ¬ν„
```
μ‹ν¬λ¦Ώ λ΅ν…μ΄μ… λ° μλ™ν™”:

μλ™ λ΅ν…μ΄μ…:
   π”Ή μ¤μΌ€μ¤„ κΈ°λ°:
      β€Ά μ •κΈ°μ  λ΅ν…μ΄μ…
      β€Ά λ§λ£ κΈ°λ° κ°±μ‹ 
      β€Ά μ •μ±… κΈ°λ° λ΅ν…μ΄μ…
      β€Ά μ„ν—λ„ κΈ°λ° μ΅°μ •
      β€Ά λΉ„μ¦λ‹μ¤ μ”κµ¬μ‚¬ν•­ λ°μ
   π”Ή μ΄λ²¤νΈ κΈ°λ°:
      β€Ά λ³΄μ• μ‚¬κ³  λ€μ‘
      β€Ά μ·¨μ•½μ  λ°κ²¬ μ‹
      β€Ά μ§μ› ν‡΄μ‚¬ μ‹
      β€Ά μ‹μ¤ν… μΉ¨ν•΄ μ‹
      β€Ά μ»΄ν”λΌμ΄μ–Έμ¤ μ”κµ¬
   π”Ή μλ™ν™” λ„κµ¬:
   π”Ή External Secrets Operator
   π”Ή Vault Agent
   π”Ή cert-manager
   π”Ή μ»¤μ¤ν…€ μ¤νΌλ μ΄ν„°
   π”Ή CI/CD ν†µν•©

λ¬΄μ¤‘λ‹¨ λ΅ν…μ΄μ…:
   π”Ή λΈ”λ£¨-κ·Έλ¦° μ „λµ:
      β€Ά μƒ μ‹ν¬λ¦Ώ μ¤€λΉ„
      β€Ά μ μ§„μ  μ „ν™
      β€Ά κ²€μ¦ ν›„ μ™„μ „ μ „ν™
      β€Ά μ΄μ „ μ‹ν¬λ¦Ώ μ •λ¦¬
      β€Ά λ΅¤λ°± κ³„ν
   π”Ή μΉ΄λ‚λ¦¬ μ „λµ:
      β€Ά μΌλ¶€ μΈμ¤ν„΄μ¤ λ¨Όμ € μ μ©
      β€Ά λ¨λ‹ν„°λ§ λ° κ²€μ¦
      β€Ά μ μ§„μ  ν™•μ‚°
      β€Ά λ¬Έμ  μ‹ μ¦‰μ‹ λ΅¤λ°±
      β€Ά μ „μ²΄ μ μ© μ™„λ£
   π”Ή νΈν™μ„± μ μ§€:
   π”Ή λ‹¤μ¤‘ λ²„μ „ μ§€μ›
   π”Ή μ μ§„μ  λ§μ΄κ·Έλ μ΄μ…
   π”Ή ν•μ„ νΈν™μ„±
   π”Ή μμ΅΄μ„± κ΄€λ¦¬
   π”Ή ν†µμ‹  ν”„λ΅ν† μ½ κ³ λ ¤
```

## π’¬ κ·Έλ£Ή ν† λ΅ : μ‹ν¬λ¦Ώ κ΄€λ¦¬ μ „λµ μ„ νƒ κΈ°μ¤€ (8λ¶„)

### ν† λ΅  μ£Όμ 
**"μ΅°μ§μ λ³΄μ• μ”κµ¬μ‚¬ν•­κ³Ό μ΄μ λ³µμ΅λ„λ¥Ό κ³ λ ¤ν• μµμ μ μ‹ν¬λ¦Ώ κ΄€λ¦¬ μ „λµμ€?"**

### ν† λ΅  κ°€μ΄λ“λΌμΈ

#### λ³΄μ• μ”κµ¬μ‚¬ν•­ (3λ¶„)
- **λ³΄μ• μμ¤€**: λ‚΄μ¥ Secret vs μ™Έλ¶€ μ‹ν¬λ¦Ώ κ΄€λ¦¬ μ‹μ¤ν…
- **μ»΄ν”λΌμ΄μ–Έμ¤**: κ·μ  μ”κµ¬μ‚¬ν•­μ— λ”°λ¥Έ μ‹ν¬λ¦Ώ κ΄€λ¦¬
- **κ°μ‚¬**: μ‹ν¬λ¦Ώ μ ‘κ·Ό λ° μ‚¬μ© μ¶”μ 

#### μ΄μ λ³µμ΅λ„ (3λ¶„)
- **κ΄€λ¦¬ ν¨μ¨μ„±**: μ¤‘μ•™μ§‘μ¤‘μ‹ vs λ¶„μ‚° κ΄€λ¦¬
- **μλ™ν™”**: λ΅ν…μ΄μ… λ° λ°°ν¬ μλ™ν™” μμ¤€
- **ν†µν•©**: κΈ°μ΅΄ μ‹μ¤ν…κ³Όμ ν†µν•© λ³µμ΅λ„

#### λΉ„μ© ν¨μ¨μ„± (2λ¶„)
- **λ„κµ¬ λΉ„μ©**: μƒμ© vs μ¤ν”μ†μ¤ μ†”λ£¨μ…
- **μ΄μ λΉ„μ©**: κ΄€λ¦¬ μΈλ ¥ λ° μ‹κ°„
- **ν™•μ¥μ„±**: μ΅°μ§ μ„±μ¥μ— λ”°λ¥Έ λΉ„μ© μ¦κ°€

## π’΅ ν•µμ‹¬ κ°λ… μ •λ¦¬
- **Secret μƒλ…μ£ΌκΈ°**: μƒμ„±, μ €μ¥, λ°°ν¬, μ‚¬μ©, λ΅ν…μ΄μ…, νκΈ°
- **μ™Έλ¶€ ν†µν•©**: Vault, ν΄λΌμ°λ“ μ‹ν¬λ¦Ώ μ„λΉ„μ¤μ™€μ μ—°λ™
- **μ•”νΈν™”**: etcd μ•”νΈν™”, KMS ν†µν•©, μ „μ†΅ μ¤‘ μ•”νΈν™”
- **μλ™ν™”**: μ‹ν¬λ¦Ώ λ΅ν…μ΄μ…κ³Ό λ¬΄μ¤‘λ‹¨ μ—…λ°μ΄νΈ

## π“ μ°Έκ³  μλ£
- [Secrets](https://kubernetes.io/docs/concepts/configuration/secret/)
- [Encrypting Secret Data at Rest](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/)
- [External Secrets Operator](https://external-secrets.io/)
- [HashiCorp Vault](https://www.vaultproject.io/docs/platform/k8s)

## λ‹¤μ μ„Έμ… μ¤€λΉ„
λ‹¤μ μ„Έμ…μ—μ„λ” **μ΄λ―Έμ§€ λ³΄μ•κ³Ό μ·¨μ•½μ  κ΄€λ¦¬**μ— λ€ν•΄ ν•™μµν•©λ‹λ‹¤. μ»¨ν…μ΄λ„ μ΄λ―Έμ§€ λ³΄μ• μ¤μΊ”κ³Ό μ·¨μ•½μ  κ΄€λ¦¬ μ „λµμ„ λ‹¤λ£° μμ •μ…λ‹λ‹¤.