# Session 5: Secret κ΄€λ¦¬μ™€ μ•”νΈν™” μ „λµ

## π“ κµκ³Όκ³Όμ •μ—μ„μ μ„μΉ
μ΄ μ„Έμ…μ€ **Week 3 > Day 2 > Session 5**λ΅, Kubernetesμ Secret κ΄€λ¦¬μ™€ μ•”νΈν™” μ „λµμ„ ν•™μµν•©λ‹λ‹¤.

## ν•™μµ λ©ν‘ (5λ¶„)
- **Secret μƒλ…μ£ΌκΈ°** κ΄€λ¦¬μ™€ **λ³΄μ• λ¨λ²” μ‚¬λ΅€** μ΄ν•΄
- **μ™Έλ¶€ μ‹ν¬λ¦Ώ κ΄€λ¦¬** μ‹μ¤ν… ν†µν•© λ°©λ²• ν•™μµ
- **μ•”νΈν™” ν‚¤ κ΄€λ¦¬** (KMS μ—°λ™)μ™€ **λ°μ΄ν„° λ³΄νΈ** μ „λµ νμ•…
- **μ‹ν¬λ¦Ώ λ΅ν…μ΄μ…**κ³Ό **μλ™ν™”** κµ¬ν„ λ°©λ²• μ΄ν•΄

## 1. Secret μƒλ…μ£ΌκΈ° κ΄€λ¦¬ (15λ¶„)

### Secret κ΄€λ¦¬ μ•„ν‚¤ν…μ²

```mermaid
graph TB
    subgraph "Secret μƒλ…μ£ΌκΈ°"
        A[μƒμ„±] --> B[μ €μ¥]
        B --> C[λ°°ν¬]
        C --> D[μ‚¬μ©]
        D --> E[λ΅ν…μ΄μ…]
        E --> F[νκΈ°]
        
        G[μ•”νΈν™”] --> B
        H[μ ‘κ·Ό μ μ–΄] --> C
        I[κ°μ‚¬] --> D
        J[μλ™ν™”] --> E
    end
```

### Secret κ΄€λ¦¬ μ „λµ
```
Secret μƒλ…μ£ΌκΈ° κ΄€λ¦¬:

Secret νƒ€μ… λ° μ©λ„:
β”β”€β”€ Opaque: μΌλ°μ μΈ μ‹ν¬λ¦Ώ
β”β”€β”€ kubernetes.io/service-account-token: μ„λΉ„μ¤ κ³„μ • ν† ν°
β”β”€β”€ kubernetes.io/dockercfg: Docker λ μ§€μ¤νΈλ¦¬ μΈμ¦
β”β”€β”€ kubernetes.io/tls: TLS μΈμ¦μ„ λ° ν‚¤
β”β”€β”€ kubernetes.io/ssh-auth: SSH μΈμ¦ ν‚¤
β”β”€β”€ kubernetes.io/basic-auth: κΈ°λ³Έ μΈμ¦ μ •λ³΄
β””β”€β”€ μ»¤μ¤ν…€ νƒ€μ…: μ• ν”λ¦¬μΌ€μ΄μ…λ³„ μ‹ν¬λ¦Ώ

μƒμ„± λ° μ €μ¥:
β”β”€β”€ μƒμ„± λ°©λ²•:
β”‚   β”β”€β”€ kubectl create secret
β”‚   β”β”€β”€ YAML λ§¤λ‹νμ¤νΈ
β”‚   β”β”€β”€ μ™Έλ¶€ λ„κµ¬ ν†µν•©
β”‚   β”β”€β”€ CI/CD νμ΄ν”„λΌμΈ
β”‚   β””β”€β”€ μλ™ μƒμ„± (cert-manager)
β”β”€β”€ μ €μ¥ λ³΄μ•:
β”‚   β”β”€β”€ etcd μ•”νΈν™”
β”‚   β”β”€β”€ μ „μ†΅ μ¤‘ μ•”νΈν™”
β”‚   β”β”€β”€ μ ‘κ·Ό κ¶ν• μ ν•
β”‚   β”β”€β”€ λ°±μ—… μ•”νΈν™”
β”‚   β””β”€β”€ κ°μ‚¬ λ΅κΉ…
β””β”€β”€ λ°μ΄ν„° ν•μ‹:
    β”β”€β”€ Base64 μΈμ½”λ”©
    β”β”€β”€ λ°”μ΄λ„λ¦¬ λ°μ΄ν„° μ§€μ›
    β”β”€β”€ ν‚¤-κ°’ μ κµ¬μ΅°
    β”β”€β”€ λ©”νƒ€λ°μ΄ν„° ν¬ν•¨
    β””β”€β”€ λΌλ²¨ λ° μ–΄λ…Έν…μ΄μ…

λ°°ν¬ λ° μ‚¬μ©:
β”β”€β”€ λ§μ΄νΈ λ°©λ²•:
β”‚   β”β”€β”€ λ³Όλ¥¨ λ§μ΄νΈ
β”‚   β”β”€β”€ ν™κ²½ λ³€μ
β”‚   β”β”€β”€ νμΌ μ‹μ¤ν… λ§μ΄νΈ
β”‚   β”β”€β”€ λ©”λ¨λ¦¬ κΈ°λ° tmpfs
β”‚   β””β”€β”€ ν”„λ΅μ μ… λ³Όλ¥¨
β”β”€β”€ μ ‘κ·Ό μ μ–΄:
β”‚   β”β”€β”€ RBAC κ¶ν• μ„¤μ •
β”‚   β”β”€β”€ λ„¤μ„μ¤νμ΄μ¤ κ²©λ¦¬
β”‚   β”β”€β”€ Pod λ λ²¨ μ ν•
β”‚   β”β”€β”€ μ„λΉ„μ¤ κ³„μ • κΈ°λ°
β”‚   β””β”€β”€ λ„¤νΈμ›ν¬ μ •μ±… μ μ©
β””β”€β”€ λ³΄μ• κ³ λ ¤μ‚¬ν•­:
    β”β”€β”€ μµμ† κ¶ν• μ›μΉ™
    β”β”€β”€ λ΅κ·Έ λ…Έμ¶ λ°©μ§€
    β”β”€β”€ λ©”λ¨λ¦¬ λ¤ν”„ λ³΄νΈ
    β”β”€β”€ ν”„λ΅μ„Έμ¤ κ²©λ¦¬
    β””β”€β”€ μ»¨ν…μ΄λ„ λ³΄μ•
```

## 2. μ™Έλ¶€ μ‹ν¬λ¦Ώ κ΄€λ¦¬ μ‹μ¤ν… ν†µν•© (12λ¶„)

### μ™Έλ¶€ μ‹ν¬λ¦Ώ ν†µν•© μ•„ν‚¤ν…μ²

```mermaid
graph TB
    subgraph "μ™Έλ¶€ μ‹ν¬λ¦Ώ κ΄€λ¦¬"
        A[HashiCorp Vault] --> B[Vault Agent]
        C[AWS Secrets Manager] --> D[External Secrets Operator]
        E[Azure Key Vault] --> F[CSI Secret Store]
        G[Google Secret Manager] --> H[Workload Identity]
        
        B --> I[Kubernetes Secret]
        D --> I
        F --> I
        H --> I
    end
```

### μ™Έλ¶€ μ‹μ¤ν… ν†µν•© μ „λµ
```
μ™Έλ¶€ μ‹ν¬λ¦Ώ κ΄€λ¦¬ μ‹μ¤ν… ν†µν•©:

HashiCorp Vault ν†µν•©:
β”β”€β”€ Vault Agent Injector:
β”‚   β”β”€β”€ μ‚¬μ΄λ“μΉ΄ ν¨ν„΄
β”‚   β”β”€β”€ μλ™ μ‹ν¬λ¦Ώ μ£Όμ…
β”‚   β”β”€β”€ ν…ν”λ¦Ώ κΈ°λ° λ λ”λ§
β”‚   β”β”€β”€ μλ™ κ°±μ‹ 
β”‚   β””β”€β”€ λ™μ  μ‹ν¬λ¦Ώ μ§€μ›
β”β”€β”€ Vault CSI Provider:
β”‚   β”β”€β”€ CSI λ“λΌμ΄λ²„ ν™μ©
β”‚   β”β”€β”€ λ³Όλ¥¨ λ§μ΄νΈ λ°©μ‹
β”‚   β”β”€β”€ νμΌ μ‹μ¤ν… κΈ°λ°
β”‚   β”β”€β”€ μλ™ λ΅ν…μ΄μ…
β”‚   β””β”€β”€ λ‹¤μ¤‘ μ‹ν¬λ¦Ώ μ§€μ›
β””β”€β”€ External Secrets Operator:
    β”β”€β”€ CRD κΈ°λ° κ΄€λ¦¬
    β”β”€β”€ λ‹¤μ–‘ν• λ°±μ—”λ“ μ§€μ›
    β”β”€β”€ μλ™ λ™κΈ°ν™”
    β”β”€β”€ μ •μ±… κΈ°λ° μ μ–΄
    β””β”€β”€ λ¨λ‹ν„°λ§ ν†µν•©

ν΄λΌμ°λ“ μ‹ν¬λ¦Ώ μ„λΉ„μ¤:
β”β”€β”€ AWS Secrets Manager:
β”‚   β”β”€β”€ IAM κΈ°λ° μΈμ¦
β”‚   β”β”€β”€ μλ™ λ΅ν…μ΄μ…
β”‚   β”β”€β”€ λ²„μ „ κ΄€λ¦¬
β”‚   β”β”€β”€ κµμ°¨ λ¦¬μ „ λ³µμ 
β”‚   β””β”€β”€ κ°μ‚¬ λ΅κΉ…
β”β”€β”€ Azure Key Vault:
β”‚   β”β”€β”€ Azure AD ν†µν•©
β”‚   β”β”€β”€ ν•λ“μ›¨μ–΄ λ³΄μ• λ¨λ“
β”‚   β”β”€β”€ μΈμ¦μ„ κ΄€λ¦¬
β”‚   β”β”€β”€ ν‚¤ κ΄€λ¦¬
β”‚   β””β”€β”€ μ•΅μ„Έμ¤ μ •μ±…
β””β”€β”€ Google Secret Manager:
    β”β”€β”€ Workload Identity
    β”β”€β”€ μλ™ μ•”νΈν™”
    β”β”€β”€ λ²„μ „ κ΄€λ¦¬
    β”β”€β”€ κ°μ‚¬ λ΅κΉ…
    β””β”€β”€ IAM ν†µν•©
```

## 3. μ•”νΈν™” ν‚¤ κ΄€λ¦¬μ™€ KMS μ—°λ™ (10λ¶„)

### μ•”νΈν™” μ•„ν‚¤ν…μ²

```mermaid
graph TB
    subgraph "μ•”νΈν™” κ³„μΈµ"
        A[Application] --> B[TLS/mTLS]
        C[Kubernetes] --> D[etcd μ•”νΈν™”]
        E[Storage] --> F[λ³Όλ¥¨ μ•”νΈν™”]
        G[Network] --> H[λ„¤νΈμ›ν¬ μ•”νΈν™”]
        
        I[KMS] --> J[ν‚¤ κ΄€λ¦¬]
        J --> B
        J --> D
        J --> F
        J --> H
    end
```

### μ•”νΈν™” μ „λµ
```
μ•”νΈν™” ν‚¤ κ΄€λ¦¬ λ° KMS μ—°λ™:

etcd μ•”νΈν™”:
β”β”€β”€ μ €μ¥ λ°μ΄ν„° μ•”νΈν™”:
β”‚   β”β”€β”€ AES-256 μ•”νΈν™”
β”‚   β”β”€β”€ ν‚¤ λν•‘
β”‚   β”β”€β”€ λ‹¤μ¤‘ ν‚¤ μ§€μ›
β”‚   β”β”€β”€ ν‚¤ λ΅ν…μ΄μ…
β”‚   β””β”€β”€ μ„±λ¥ μµμ ν™”
β”β”€β”€ KMS ν†µν•©:
β”‚   β”β”€β”€ AWS KMS
β”‚   β”β”€β”€ Azure Key Vault
β”‚   β”β”€β”€ Google Cloud KMS
β”‚   β”β”€β”€ HashiCorp Vault
β”‚   β””β”€β”€ μ¨ν”„λ λ―Έμ¤ HSM
β””β”€β”€ μ„¤μ • κ΄€λ¦¬:
    β”β”€β”€ EncryptionConfiguration
    β”β”€β”€ ν‚¤ κ³„μΈµ κµ¬μ΅°
    β”β”€β”€ μ•”νΈν™” λ²”μ„ μ„¤μ •
    β”β”€β”€ μ„±λ¥ νλ‹
    β””β”€β”€ λ¨λ‹ν„°λ§ μ„¤μ •

μ „μ†΅ μ¤‘ μ•”νΈν™”:
β”β”€β”€ ν΄λ¬μ¤ν„° λ‚΄λ¶€:
β”‚   β”β”€β”€ API μ„λ²„ TLS
β”‚   β”β”€β”€ etcd ν΄λΌμ΄μ–ΈνΈ TLS
β”‚   β”β”€β”€ kubelet TLS
β”‚   β”β”€β”€ μ„λΉ„μ¤ λ©”μ‹ mTLS
β”‚   β””β”€β”€ CNI μ•”νΈν™”
β”β”€β”€ μ™Έλ¶€ ν†µμ‹ :
β”‚   β”β”€β”€ Ingress TLS
β”‚   β”β”€β”€ LoadBalancer TLS
β”‚   β”β”€β”€ μ™Έλ¶€ μ„λΉ„μ¤ μ—°λ™
β”‚   β”β”€β”€ ν΄λΌμ°λ“ μ„λΉ„μ¤ ν†µμ‹ 
β”‚   β””β”€β”€ ν•μ΄λΈλ¦¬λ“ μ—°κ²°
β””β”€β”€ μΈμ¦μ„ κ΄€λ¦¬:
    β”β”€β”€ cert-manager
    β”β”€β”€ μλ™ κ°±μ‹ 
    β”β”€β”€ μΈμ¦μ„ μ²΄μΈ
    β”β”€β”€ OCSP κ²€μ¦
    β””β”€β”€ μΈμ¦μ„ λ¨λ‹ν„°λ§
```

## 4. μ‹ν¬λ¦Ώ λ΅ν…μ΄μ…κ³Ό μλ™ν™” (10λ¶„)

### μλ™ν™” μ›ν¬ν”λ΅μ°

```mermaid
graph TB
    subgraph "μ‹ν¬λ¦Ώ λ΅ν…μ΄μ…"
        A[μ¤μΌ€μ¤„λ¬] --> B[λ΅ν…μ΄μ… νΈλ¦¬κ±°]
        B --> C[μƒ μ‹ν¬λ¦Ώ μƒμ„±]
        C --> D[λ°°ν¬ λ° κ²€μ¦]
        D --> E[μ΄μ „ μ‹ν¬λ¦Ώ νκΈ°]
        
        F[λ¨λ‹ν„°λ§] --> G[λ§λ£ κ°μ§€]
        G --> B
        
        H[μ΄λ²¤νΈ] --> I[κΈ΄κΈ‰ λ΅ν…μ΄μ…]
        I --> B
    end
```

### μλ™ν™” κµ¬ν„
```
μ‹ν¬λ¦Ώ λ΅ν…μ΄μ… λ° μλ™ν™”:

μλ™ λ΅ν…μ΄μ…:
β”β”€β”€ μ¤μΌ€μ¤„ κΈ°λ°:
β”‚   β”β”€β”€ μ •κΈ°μ  λ΅ν…μ΄μ…
β”‚   β”β”€β”€ λ§λ£ κΈ°λ° κ°±μ‹ 
β”‚   β”β”€β”€ μ •μ±… κΈ°λ° λ΅ν…μ΄μ…
β”‚   β”β”€β”€ μ„ν—λ„ κΈ°λ° μ΅°μ •
β”‚   β””β”€β”€ λΉ„μ¦λ‹μ¤ μ”κµ¬μ‚¬ν•­ λ°μ
β”β”€β”€ μ΄λ²¤νΈ κΈ°λ°:
β”‚   β”β”€β”€ λ³΄μ• μ‚¬κ³  λ€μ‘
β”‚   β”β”€β”€ μ·¨μ•½μ  λ°κ²¬ μ‹
β”‚   β”β”€β”€ μ§μ› ν‡΄μ‚¬ μ‹
β”‚   β”β”€β”€ μ‹μ¤ν… μΉ¨ν•΄ μ‹
β”‚   β””β”€β”€ μ»΄ν”λΌμ΄μ–Έμ¤ μ”κµ¬
β””β”€β”€ μλ™ν™” λ„κµ¬:
    β”β”€β”€ External Secrets Operator
    β”β”€β”€ Vault Agent
    β”β”€β”€ cert-manager
    β”β”€β”€ μ»¤μ¤ν…€ μ¤νΌλ μ΄ν„°
    β””β”€β”€ CI/CD ν†µν•©

λ¬΄μ¤‘λ‹¨ λ΅ν…μ΄μ…:
β”β”€β”€ λΈ”λ£¨-κ·Έλ¦° μ „λµ:
β”‚   β”β”€β”€ μƒ μ‹ν¬λ¦Ώ μ¤€λΉ„
β”‚   β”β”€β”€ μ μ§„μ  μ „ν™
β”‚   β”β”€β”€ κ²€μ¦ ν›„ μ™„μ „ μ „ν™
β”‚   β”β”€β”€ μ΄μ „ μ‹ν¬λ¦Ώ μ •λ¦¬
β”‚   β””β”€β”€ λ΅¤λ°± κ³„ν
β”β”€β”€ μΉ΄λ‚λ¦¬ μ „λµ:
β”‚   β”β”€β”€ μΌλ¶€ μΈμ¤ν„΄μ¤ λ¨Όμ € μ μ©
β”‚   β”β”€β”€ λ¨λ‹ν„°λ§ λ° κ²€μ¦
β”‚   β”β”€β”€ μ μ§„μ  ν™•μ‚°
β”‚   β”β”€β”€ λ¬Έμ  μ‹ μ¦‰μ‹ λ΅¤λ°±
β”‚   β””β”€β”€ μ „μ²΄ μ μ© μ™„λ£
β””β”€β”€ νΈν™μ„± μ μ§€:
    β”β”€β”€ λ‹¤μ¤‘ λ²„μ „ μ§€μ›
    β”β”€β”€ μ μ§„μ  λ§μ΄κ·Έλ μ΄μ…
    β”β”€β”€ ν•μ„ νΈν™μ„±
    β”β”€β”€ μμ΅΄μ„± κ΄€λ¦¬
    β””β”€β”€ ν†µμ‹  ν”„λ΅ν† μ½ κ³ λ ¤
```

## π’¬ κ·Έλ£Ή ν† λ΅ : μ‹ν¬λ¦Ώ κ΄€λ¦¬ μ „λµ μ„ νƒ κΈ°μ¤€ (8λ¶„)

### ν† λ΅  μ£Όμ 
**"μ΅°μ§μ λ³΄μ• μ”κµ¬μ‚¬ν•­κ³Ό μ΄μ λ³µμ΅λ„λ¥Ό κ³ λ ¤ν• μµμ μ μ‹ν¬λ¦Ώ κ΄€λ¦¬ μ „λµμ€?"**

### ν† λ΅  κ°€μ΄λ“λΌμΈ

#### λ³΄μ• μ”κµ¬μ‚¬ν•­ (3λ¶„)
- **λ³΄μ• μμ¤€**: λ‚΄μ¥ Secret vs μ™Έλ¶€ μ‹ν¬λ¦Ώ κ΄€λ¦¬ μ‹μ¤ν…
- **μ»΄ν”λΌμ΄μ–Έμ¤**: κ·μ  μ”κµ¬μ‚¬ν•­μ— λ”°λ¥Έ μ‹ν¬λ¦Ώ κ΄€λ¦¬
- **κ°μ‚¬**: μ‹ν¬λ¦Ώ μ ‘κ·Ό λ° μ‚¬μ© μ¶”μ 

#### μ΄μ λ³µμ΅λ„ (3λ¶„)
- **κ΄€λ¦¬ ν¨μ¨μ„±**: μ¤‘μ•™μ§‘μ¤‘μ‹ vs λ¶„μ‚° κ΄€λ¦¬
- **μλ™ν™”**: λ΅ν…μ΄μ… λ° λ°°ν¬ μλ™ν™” μμ¤€
- **ν†µν•©**: κΈ°μ΅΄ μ‹μ¤ν…κ³Όμ ν†µν•© λ³µμ΅λ„

#### λΉ„μ© ν¨μ¨μ„± (2λ¶„)
- **λ„κµ¬ λΉ„μ©**: μƒμ© vs μ¤ν”μ†μ¤ μ†”λ£¨μ…
- **μ΄μ λΉ„μ©**: κ΄€λ¦¬ μΈλ ¥ λ° μ‹κ°„
- **ν™•μ¥μ„±**: μ΅°μ§ μ„±μ¥μ— λ”°λ¥Έ λΉ„μ© μ¦κ°€

## π’΅ ν•µμ‹¬ κ°λ… μ •λ¦¬
- **Secret μƒλ…μ£ΌκΈ°**: μƒμ„±, μ €μ¥, λ°°ν¬, μ‚¬μ©, λ΅ν…μ΄μ…, νκΈ°
- **μ™Έλ¶€ ν†µν•©**: Vault, ν΄λΌμ°λ“ μ‹ν¬λ¦Ώ μ„λΉ„μ¤μ™€μ μ—°λ™
- **μ•”νΈν™”**: etcd μ•”νΈν™”, KMS ν†µν•©, μ „μ†΅ μ¤‘ μ•”νΈν™”
- **μλ™ν™”**: μ‹ν¬λ¦Ώ λ΅ν…μ΄μ…κ³Ό λ¬΄μ¤‘λ‹¨ μ—…λ°μ΄νΈ

## π“ μ°Έκ³  μλ£
- [Secrets](https://kubernetes.io/docs/concepts/configuration/secret/)
- [Encrypting Secret Data at Rest](https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/)
- [External Secrets Operator](https://external-secrets.io/)
- [HashiCorp Vault](https://www.vaultproject.io/docs/platform/k8s)

## λ‹¤μ μ„Έμ… μ¤€λΉ„
λ‹¤μ μ„Έμ…μ—μ„λ” **μ΄λ―Έμ§€ λ³΄μ•κ³Ό μ·¨μ•½μ  κ΄€λ¦¬**μ— λ€ν•΄ ν•™μµν•©λ‹λ‹¤. μ»¨ν…μ΄λ„ μ΄λ―Έμ§€ λ³΄μ• μ¤μΊ”κ³Ό μ·¨μ•½μ  κ΄€λ¦¬ μ „λµμ„ λ‹¤λ£° μμ •μ…λ‹λ‹¤.