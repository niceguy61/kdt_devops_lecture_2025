# Week 3 Day 4 Challenge 1 - ë¬¸ì œ 2: ì¸ì¦ì„œ ë§Œë£Œ ì‹œë®¬ë ˆì´ì…˜
# Kind í´ëŸ¬ìŠ¤í„°ì—ì„œëŠ” ì‹¤ì œ ì¸ì¦ì„œ ë§Œë£Œë¥¼ ì‹œë®¬ë ˆì´ì…˜í•˜ê¸° ì–´ë ¤ìš°ë¯€ë¡œ
# ì¸ì¦ì„œ ê°±ì‹  í”„ë¡œì„¸ìŠ¤ë¥¼ í…ŒìŠ¤íŠ¸í•˜ëŠ” ë¦¬ì†ŒìŠ¤

apiVersion: v1
kind: ConfigMap
metadata:
  name: cert-info
  namespace: securebank
data:
  cert-check.sh: |
    #!/bin/bash
    # ì¸ì¦ì„œ ë§Œë£Œ í™•ì¸ ìŠ¤í¬ë¦½íŠ¸
    echo "=== Kubernetes ì¸ì¦ì„œ í™•ì¸ ==="
    
    # API Server ì¸ì¦ì„œ í™•ì¸ (Kind í™˜ê²½)
    echo "1. API Server ì¸ì¦ì„œ:"
    kubectl get --raw /healthz/ready
    
    # ServiceAccount í† í° í™•ì¸
    echo "2. ServiceAccount í† í°:"
    kubectl get sa developer-sa -n securebank -o yaml
    
    echo ""
    echo "ğŸ’¡ ì‹¤ì œ í™˜ê²½ì—ì„œëŠ” ë‹¤ìŒ ëª…ë ¹ì–´ë¡œ ì¸ì¦ì„œ í™•ì¸:"
    echo "kubeadm certs check-expiration"
    echo "openssl x509 -in /etc/kubernetes/pki/apiserver.crt -noout -dates"
---
apiVersion: v1
kind: Pod
metadata:
  name: cert-checker
  namespace: securebank
spec:
  serviceAccountName: developer-sa
  containers:
  - name: checker
    image: bitnami/kubectl:latest
    command: ["/bin/sh", "-c", "sleep 3600"]
  restartPolicy: Never
